{layout '../@layout.latte'}

{varType string $screenHash}
{varType App\GameModels\Game\Game|null $game}
{varType array $widgets}

{varType App\Gate\Settings\RtspSettings $settings}
{var int $maxStreams = min($settings->maxStreams, count($settings->streams))}

{define containerClasses}
    today-rtsp
{/define}

{define content}
    {cache 'gate.screen.today.rtsp.'.$screenHash, expire: '1 days', tags: ['templates', 'templates.gate', 'templates.gate.screens', 'templates.gate.screens.today']}
        <h1 class="title text-center text-white-forced">{lang 'VÃ½sledky dne', context: 'gate'}</h1>

        <div class="streams" data-max-streams="{$maxStreams}"
             data-streams="{json_encode($settings->streams)}" style="grid-template-rows: repeat({$maxStreams}, 1fr);">
            <video n:for="$i = 0; $i < $maxStreams; $i++"
                    data-index="{$i}"
                    class="stream"
                    muted
                    autoplay>
                <source src="{$settings->streams[$i]}" type="application/x-mpegURL">
            </video>
        </div>

        {foreach $widgets as $widget}
            {include '../widgets/'.$widget['template'], ...$widget['data']}
        {/foreach}
    {/cache}
{/define}